#summary Design Document for Twitter-like Application Built on Hypertable

= Introduction =

This document describes how a simple Twitter-like application can be built on Hypertable.  It's a stripped down version of Twitter that contains a user's tweet stream as well as a pane containing current user information (number of tweets, latest tweet, following, and followers).

= Details =

== Tables ==

=== Table: `profile` ===

_rowkey:  username_

{{{
CREATE TABLE profile (
  guid,
  'display_name',
  password,
  avatar,
  bio,
  url
);
}}}

This table contains profile information for each user.

=== Table: `user` ===

_rowkey: username_

{{{
CREATE TABLE user (
  following MAX_VERSIONS=1,
  'following_history',
  followers MAX_VERSIONS=1,
  'followers_history',
  'follow_stream',
  'follow_stream_count' COUNTER,
  'my_stream',
  'my_stream_counter' COUNTER
);
}}}



=== Table: `tweet` ===

_rowkey: username+timestamp_milliseconds_

{{{
CREATE TABLE tweet (
  message
);
}}}

== Actions ==

=== Action: Register New User ===

The first step of this action is to find a unique username.  This will be accomplished by calling an API (TBD) that allows you to atomically insert a column, if it does not already exists, and return the column value.  For example:

{{{
$username = /* ask user for username */
$guid = /* generate guid */
$old_guid = 0
while ($guid != $old_guid) {
  if ($old_guid != 0) {
    /* report error; ask user for a different username */
  }
  $old_guid = INSERT_ONCE_RETURN INTO profile ($username, "guid", "$guid")
}
}}}

Once a unique username (row in the profile table) has been selected, other profile information can be inserted into to the profile table.

=== Follow ===



=== Unfollow ===

=== Tweet ===

== Rendering ==

=== User Information ===

=== Tweet Stream ===

=== Other Users's Recent Tweets ===